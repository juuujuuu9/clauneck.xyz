const Q="modulepreload",Z=function(t){return"/"+t},D={},z=function(s,r,e){let c=Promise.resolve();if(r&&r.length>0){let a=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=h?.nonce||h?.getAttribute("nonce");c=a(r.map(p=>{if(p=Z(p),p in D)return;D[p]=!0;const b=p.endsWith(".css"),T=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${T}`))return;const u=document.createElement("link");if(u.rel=b?"stylesheet":Q,b||(u.as="script"),u.crossOrigin="",u.href=p,g&&u.setAttribute("nonce",g),document.head.appendChild(u),b)return new Promise((w,v)=>{u.addEventListener("load",w),u.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${p}`)))})}))}function d(a){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=a,window.dispatchEvent(h),!h.defaultPrevented)throw a}return c.then(a=>{for(const h of a||[])h.status==="rejected"&&d(h.reason);return s().catch(d)})};async function x(t){const s=await fetch("/api/hash",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:t})});if(!s.ok)throw new Error("Failed to hash input");return(await s.json()).hash}function tt(t){const s=[];for(let r=0;r<8;r++){let c=parseInt(t.substring(r*8,(r+1)*8),16)||1;s.push(()=>(c=Math.imul(1597334677,c)>>>0,c/4294967296))}return s}function et(t){return{matrix:parseInt(t.substring(0,8),16)||1,symmetry:parseInt(t.substring(8,16),16)||1,iterations:parseInt(t.substring(16,24),16)||1,color:parseInt(t.substring(24,32),16)||1,noise:parseInt(t.substring(32,40),16)||1,structure:parseInt(t.substring(40,48),16)||1}}function ot(t){const s=t.getContext("2d");if(!s)return null;const r=window.devicePixelRatio||1,e=t.style.display==="none"||t.style.visibility==="hidden";e&&(t.style.display,t.style.visibility,t.style.display="block",t.style.visibility="visible",t.offsetHeight);const c=t.getBoundingClientRect(),d=window.getComputedStyle(t);let a=c.width;if(a<=0||isNaN(a)){const p=d.width;a=p?parseInt(p):400}a=Math.max(100,Math.min(a,400)),e&&(t.style.display="",t.style.visibility="");const h=t.getBoundingClientRect(),g=Math.min(h.width,h.height)||a;return t.width=g*r,t.height=g*r,s.setTransform(1,0,0,1,0,0),s.scale(r,r),{ctx:s,size:g,dpr:r}}function nt(t,s,r,e,c,d=0){t.beginPath();for(let a=0;a<=c;a++){const h=a*Math.PI*2/c+d,g=s+Math.cos(h)*e,p=r+Math.sin(h)*e;a===0?t.moveTo(g,p):t.lineTo(g,p)}t.stroke()}function it(t,s,r,e,c,d,a=0){t.beginPath();for(let h=0;h<=d*2;h++){const g=h*Math.PI/d+a,p=h%2===0?e:c,b=s+Math.cos(g)*p,T=r+Math.sin(g)*p;h===0?t.moveTo(b,T):t.lineTo(b,T)}t.closePath(),t.stroke()}function B(t,s,r,e,c,d=0){const a=c%6;if(a===0)t.beginPath(),t.arc(s,r,e,0,Math.PI*2),t.stroke();else if(a===1)t.beginPath(),t.save(),t.translate(s,r),t.rotate(d),t.rect(-e,-e,e*2,e*2),t.restore(),t.stroke();else if(a===2)t.beginPath(),t.save(),t.translate(s,r),t.rotate(d),t.moveTo(0,-e),t.lineTo(-e*.866,e*.5),t.lineTo(e*.866,e*.5),t.closePath(),t.restore(),t.stroke();else if(a===3)nt(t,s,r,e,6,d);else if(a===4){const h=e*.4;it(t,s,r,e,h,5,d)}else t.beginPath(),t.save(),t.translate(s,r),t.rotate(d),t.moveTo(0,-e),t.lineTo(e,0),t.lineTo(0,e),t.lineTo(-e,0),t.closePath(),t.restore(),t.stroke()}function st(t,s,r,e,c){t.clearRect(0,0,s,s),t.save();const d=s/2,a=s/2;t.translate(d,a);const h=2+c.symmetry%7,g=c.symmetry%360*Math.PI/180,p=c.color%360,b=50+c.color%30,T=35+c.color%20;t.strokeStyle=`hsl(${p}, ${b}%, ${T}%)`,t.lineWidth=.8+e[0]()*1.5;const u=s*(.35+e[1]()*.15),w=c.matrix%4;let v=null;if(w===1||w===3){const o=e[2]()*Math.PI*2,i=u*(.1+e[3]()*.3);v={x:Math.cos(o)*i,y:Math.sin(o)*i}}const E=[];if(w===2||w===3){const o=2+Math.floor(e[4]()*4);for(let i=0;i<o;i++){const n=e[(i+5)%e.length]()*Math.PI*2,l=u*(.1+e[(i+6)%e.length]()*.4);E.push({x:Math.cos(n)*l,y:Math.sin(n)*l})}}const W=e[5]()>.5,S=[];if(W){const o=1+Math.floor(e[6]()*3),i=[{x:-u*.8,y:-u*.8},{x:u*.8,y:-u*.8},{x:-u*.8,y:u*.8},{x:u*.8,y:u*.8}];for(let n=0;n<o;n++){const l=i[n%4],f=2+Math.floor(e[7]()*4);for(let m=0;m<f;m++){const M=(e[(n*10+m)%e.length]()-.5)*u*.15,L=(e[(n*10+m+1)%e.length]()-.5)*u*.15,X=1+e[(n*10+m+2)%e.length]()*3.5,Y=Math.floor(e[(n*10+m+3)%e.length]()*6),K=e[(n*10+m+4)%e.length]()*Math.PI*2;S.push({x:l.x+M,y:l.y+L,size:X,shape:Y,rotation:K})}}}const O=3+c.structure%8,N=[];for(let o=0;o<O;o++){const i=o*Math.PI*2/O+g,n=(e[o%e.length]()-.5)*.4,l=i+n,f=u*(.4+e[(o+2)%e.length]()*.5),m=1+e[(o+3)%e.length]()*4,M=Math.floor(e[(o+4)%e.length]()*6),L=e[(o+5)%e.length]()*Math.PI*2;N.push({x:Math.cos(l)*f,y:Math.sin(l)*f,size:m,shape:M,rotation:L})}const y=[];for(const o of N)for(let i=0;i<h;i++){const n=i*Math.PI*2/h,l=Math.cos(n),f=Math.sin(n);y.push({x:o.x*l-o.y*f,y:o.x*f+o.y*l,size:o.size,shape:o.shape,rotation:o.rotation+n})}const V=Math.floor(e[0]()*8),_=[];for(let o=0;o<V;o++){const i=e[(o+1)%e.length]()*Math.PI*2,n=u*(.2+e[(o+2)%e.length]()*.7),l=.8+e[(o+3)%e.length]()*3.5,f=Math.floor(e[(o+4)%e.length]()*6),m=e[(o+5)%e.length]()*Math.PI*2;_.push({x:Math.cos(i)*n,y:Math.sin(i)*n,size:l,shape:f,rotation:m})}const P=[...y,...S,..._];if(w===0||w===3){const o=1.5+e[0]()*3.5,i=Math.floor(e[1]()*6),n=e[2]()*Math.PI*2;B(t,0,0,o,i,n)}if(v){const o=1.5+e[1]()*2.5,i=Math.floor(e[2]()*6),n=e[3]()*Math.PI*2;B(t,v.x,v.y,o,i,n)}for(let o=0;o<E.length;o++){const i=E[o],n=1+e[(o+2)%e.length]()*2.5,l=Math.floor(e[(o+3)%e.length]()*6),f=e[(o+4)%e.length]()*Math.PI*2;B(t,i.x,i.y,n,l,f)}for(const o of P)B(t,o.x,o.y,o.size,o.shape,o.rotation);if(t.lineWidth=.8+e[3]()*1.2,w===0||w===3){const o=.3+e[4]()*.4;for(const i of P)e[5]()>o&&(t.beginPath(),t.moveTo(0,0),t.lineTo(i.x,i.y),t.stroke())}if(v){const o=.4+e[6]()*.3;for(const i of P)e[7]()>o&&(t.beginPath(),t.moveTo(v.x,v.y),t.lineTo(i.x,i.y),t.stroke())}for(let o=0;o<E.length;o++){const i=E[o],n=.5+e[(o+4)%e.length]()*.3,l=Math.floor(e[(o+5)%e.length]()*(P.length/2));for(let f=0;f<l;f++){const m=Math.floor(e[(o+f+6)%e.length]()*P.length),M=P[m];e[(o+f+7)%e.length]()>n&&(t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(M.x,M.y),t.stroke())}}const C=c.noise%4;if(C===0&&y.length>1)for(let o=0;o<y.length;o++){const i=(o+1)%y.length,n=y[o],l=y[i];e[o%e.length]()>.3&&(t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(l.x,l.y),t.stroke())}else if(C===1){if(y.length>2){const o=3+Math.floor(e[0]()*6),i=Math.max(1,Math.floor(y.length/o));for(let n=0;n<o;n++){const l=n*i%y.length,f=y[l];t.beginPath(),t.moveTo(0,0),t.lineTo(f.x,f.y),t.stroke()}for(let n=0;n<o;n++){const l=n*i%y.length,f=(n+1)*i%y.length,m=y[l],M=y[f];t.beginPath(),t.moveTo(m.x,m.y),t.lineTo(M.x,M.y),t.stroke()}}}else if(C===2){if(P.length>2&&(v||E.length>0)){const o=v||E[0],i=3+Math.floor(e[1]()*6),n=[];for(let l=0;l<i;l++){const f=Math.floor(e[(l+2)%e.length]()*P.length);n.push(P[f])}for(const l of n)t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(l.x,l.y),t.stroke();for(let l=0;l<n.length;l++){const f=(l+1)%n.length,m=n[l],M=n[f];t.beginPath(),t.moveTo(m.x,m.y),t.lineTo(M.x,M.y),t.stroke()}}}else for(let o=0;o<P.length;o++)if(e[o%e.length]()>.7){const i=Math.floor(e[(o+1)%e.length]()*P.length);if(i!==o){const n=P[o],l=P[i];t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(l.x,l.y),t.stroke()}}if(S.length>1){for(let o=0;o<S.length-1;o++)if(e[o%e.length]()>.6){const i=S[o],n=S[o+1];Math.sqrt((n.x-i.x)**2+(n.y-i.y)**2)<u*.5&&(t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(n.x,n.y),t.stroke())}}t.restore()}function lt(t){const s=document.createElement("a");s.download="sigil.png",s.href=t.toDataURL("image/png"),s.click()}function at(t){const s=document.createElement("a");s.download="sigil.jpg",s.href=t.toDataURL("image/jpeg",.95),s.click()}async function rt(t){const{jsPDF:s}=await z(async()=>{const{jsPDF:e}=await import("./jspdf.es.min.mjhIj_r_.js").then(c=>c.j);return{jsPDF:e}},[]),r=new s({orientation:"portrait",unit:"px",format:[t.width,t.height]});r.addImage(t.toDataURL("image/png"),"PNG",0,0,t.width,t.height),r.save("sigil.pdf")}const F=document.getElementById("continue-btn"),q=document.querySelector(".preface"),R=document.querySelector(".request"),U=document.getElementById("generate-btn"),$=document.getElementById("request-input"),k=document.getElementById("sigil-container"),I=document.getElementById("sigil-canvas"),H=document.getElementById("export-png-btn"),G=document.getElementById("export-jpeg-btn"),J=document.getElementById("export-pdf-btn"),j=document.getElementById("ascii-art"),A=document.getElementById("export-buttons-container");F&&q&&R&&F.addEventListener("click",()=>{q.style.opacity="0",q.style.pointerEvents="none",setTimeout(()=>{R.style.opacity="1",R.style.pointerEvents="auto"},250)});U&&$&&k&&I&&j&&R&&A&&U.addEventListener("click",async()=>{const t=$.value.trim();if(!t)return;const s=t.toLowerCase().replace(/\s+/g," ").trim(),r=await x(s),e=et(r),c=tt(r);k.style.display="flex",k.style.visibility="visible",k.style.opacity="0",k.offsetHeight,I.offsetHeight,await new Promise(a=>requestAnimationFrame(a)),await new Promise(a=>requestAnimationFrame(a));const d=ot(I);if(d){d.size>0&&st(d.ctx,d.size,d.dpr,c,e),j.style.opacity="0",j.style.pointerEvents="none",R.style.opacity="0",R.style.pointerEvents="none",window.scrollTo({top:0,left:0,behavior:"instant"});const a=document.querySelector('meta[name="viewport"]');a&&a.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"),document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),setTimeout(()=>{k.style.opacity="1",k.style.pointerEvents="auto",A.style.opacity="1",A.style.pointerEvents="auto",window.scrollTo({top:0,left:0,behavior:"instant"})},250)}});I&&H&&H.addEventListener("click",()=>lt(I));I&&G&&G.addEventListener("click",()=>at(I));I&&J&&J.addEventListener("click",()=>rt(I));export{z as _};
